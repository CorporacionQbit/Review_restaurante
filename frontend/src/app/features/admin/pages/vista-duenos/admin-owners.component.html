<div class="admin-page">

  <!-- HEADER IGUAL A USUARIOS -->
  <div class="admin-header orange">
    ðŸ‘¤ DueÃ±os de restaurantes
  </div>

  <!-- CARD CONTENEDORA -->
  <div class="admin-card">

    <!-- TABLA DE OWNERS -->
    <nz-table
      nzBordered
      [nzData]="owners"
      [nzLoading]="loading"
      [nzShowPagination]="false"
    >
      <thead>
        <tr>
          <th>Nombre</th>
          <th>Email</th>
          <th>Estado</th>
          <th>Total</th>
          <th>Aprobados</th>
          <th>Pendientes</th>
          <th>Rechazados</th>
          <th>Acciones</th>
        </tr>
      </thead>

      <tbody>
        <tr *ngFor="let o of owners">
          <td>{{ o.fullName }}</td>
          <td>{{ o.email }}</td>

          <td>
            <nz-tag [nzColor]="o.isActive ? 'green' : 'red'">
              {{ o.isActive ? 'Cuenta activa' : 'Cuenta desactivada' }}
            </nz-tag>
          </td>

          <td>{{ o.totalrestaurants }}</td>
          <td>{{ o.approved }}</td>
          <td>{{ o.pending }}</td>
          <td>{{ o.rejected }}</td>

          <td class="actions">
            <button
              nz-button
              nzType="primary"
              nzSize="small"
              (click)="openRestaurants(o)"
            >
              Ver restaurantes
            </button>

            <button
              nz-button
              nzSize="small"
              nzDanger
              [nzType]="o.isActive ? 'default' : 'primary'"
              (click)="toggleOwner(o)"
            >
              {{ o.isActive ? 'Desactivar cuenta' : 'Activar cuenta' }}
            </button>
          </td>
        </tr>
      </tbody>
    </nz-table>

    <!-- PAGINACIÃ“N -->
    <nz-pagination
      class="admin-pagination"
      [nzPageIndex]="page"
      [nzTotal]="total"
      [nzPageSize]="limit"
      (nzPageIndexChange)="loadOwners($event)"
    >
    </nz-pagination>

  </div>
</div>

<!-- MODAL RESTAURANTES -->
<ng-template #restaurantsTpl>
  <nz-table
    nzSize="small"
    [nzData]="restaurants"
    [nzLoading]="restaurantsLoading"
    [nzFrontPagination]="false"
  >
    <thead>
      <tr>
        <th>Nombre</th>
        <th>Ciudad</th>
        <th>Zona</th>
        <th>Estado</th>
      </tr>
    </thead>

    <tbody>
      <tr *ngFor="let r of restaurants">
        <td>{{ r.name }}</td>
        <td>{{ r.city }}</td>
        <td>{{ r.zone }}</td>
        <td>
          <nz-tag
            [nzColor]="
              r.onboardingStatus === 'Aprobado'
                ? 'green'
                : r.onboardingStatus === 'Pendiente'
                ? 'orange'
                : 'red'
            "
          >
            {{ r.onboardingStatus }}
          </nz-tag>
        </td>
      </tr>
    </tbody>
  </nz-table>

  <div
    *ngIf="!restaurantsLoading && restaurants.length === 0"
    class="empty"
  >
    Este dueÃ±o no tiene restaurantes registrados
  </div>
</ng-template>

<nz-modal
  [(nzVisible)]="restaurantsModalVisible"
  nzTitle="Restaurantes del dueÃ±o"
  [nzContent]="restaurantsTpl"
  [nzFooter]="null"
  nzWidth="900px"
  (nzOnCancel)="closeRestaurantsModal()"
>
</nz-modal>
